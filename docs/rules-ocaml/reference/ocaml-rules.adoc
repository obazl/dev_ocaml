// GENERATED FILE - do not edit
= OCaml Rules
:page-permalink: /:path/ocaml-rules
:page-layout: page_rules_ocaml
:page-pkg: rules_ocaml
:page-doc: refman
:page-tags: [configation,defaults]
:page-keywords: notes, tips, cautions, warnings, admonitions
:page-last_updated: June 2, 2022
:page-toc: false

**WARNING** Beta version - subject to change

== Configurable defaults

These options and flags apply to all `ocaml_*` rules. They can be
overridden on the command line; for example, to enable verbosity
(`-verbose`) for all `ocaml_*` build targets, pass
`--@ocaml//verbose`. See
link:../user-guide/configurable-defaults[Configurable Defaults] for
more information.

In addition to the options and flags listed here, which apply to all
`ocaml_*` rule instances, each rule may have its own set of
configurable defaults.

=== Options

May be enums, strings, labels, etc.

[.rule_attrs]
[cols="1,1,1"]
|===
| Label | Default | x

| @rules_ocaml//build/mode | @ocaml//build/mode:native | Enum: :bytecode, :native

| @rules_ocaml//build/cc/mode | @ocaml//build/cc/mode:fastbuild | Enum: :dbg, :fastbuild, :opt

| @rules_ocaml//build/profile | @ocaml//build/profile:fastbuild | Enum: :dbg, :fastbuild, :opt
|===

NOTE: CC build mode is set by passing `--compilation_mode`
(equivalently `-c`) on the command line, e.g. `-c opt`. This sets the
value of `@rules_ocaml//build/cc/mode`.

=== Flags

Each boolean flag `foo` may be enabled by `--@ocaml//foo` or
`--@ocaml//foo:enable`, and disabled with `--no@ocaml//foo` or
`--@ocaml//foo:disable`. Each flag has a corresponding OCaml option
and an OBazl (not an OCaml) negation; see
xref:../user-guide/configurable-defaults#_disabling[Configurable_Defaults:
Disabling] for information on how to use negated options to override
defaults.

[.rule_attrs]
[cols="1,1,1"]
|===
| Label | Default | `opts` attrib

| @rules_ocaml//cfg/debug | disabled | `-g`, `-no-g`

| @rules_ocaml//cfg/cmt | disabled | `-bin-annot`, `-no-bin-annot`

| @rules_ocaml//cfg/keep-locs | enabled | `-keep-locs`, `-no-keep-locs`

| @rules_ocaml//cfg/noassert | enabled | `-noassert`, `-no-noassert`

| @rules_ocaml//cfg/opaque | disabled | `-opaque`, `-no-opaque`

| @rules_ocaml//cfg/short-paths | enabled | `-short-paths`, `-no-short-paths`

| @rules_ocaml//cfg/strict-formats | enabled | `-strict-formats`, `-no-strict-formats`

| @rules_ocaml//cfg/strict-sequence | enabled | `-strict-sequence`, `-no-strict-sequence`

| @rules_ocaml//cfg/verbose^1^ | disabled | `-verbose`, `-no-verbose`

|===

^1^ Each `ocaml_*` rule also has it's own `verbose` flag.


== ocaml_binary

[.prototype]
pass:[
ocaml_binary(<a href="#ocaml_binary-name">name</a>, <a href="#ocaml_binary-data">data</a>, <a href="#ocaml_binary-cc_deps">cc_deps</a>, <a href="#ocaml_binary-cc_linkall">cc_linkall</a>, <a href="#ocaml_binary-cc_linkopts">cc_linkopts</a>, <a href="#ocaml_binary-data_prefix_map">data_prefix_map</a>, <a href="#ocaml_binary-env">env</a>, <a href="#ocaml_binary-epilogue">epilogue</a>, <a href="#ocaml_binary-exe">exe</a>,
             <a href="#ocaml_binary-main">main</a>, <a href="#ocaml_binary-opts">opts</a>, <a href="#ocaml_binary-prologue">prologue</a>, <a href="#ocaml_binary-vm_runtime">vm_runtime</a>)
]

Generates an OCaml executable binary.

**CONFIGURABLE DEFAULTS** for rule `ocaml_binary`

In addition to the <<Configurable defaults>> that
apply to all `ocaml_*` rules, the following apply to this rule. (Note
the difference between '/' and ':' in such labels):

[.rule_attrs]
[cols="1,1,1"]
|===
| Label | Default | `opts` attrib

| @rules_ocaml//cfg/executable/linkall | True | `-linkall`, `-no-linkall`

| @rules_ocaml//cfg/executable:warnings | `@1..3@5..28@30..39@43@46..47@49..57@61..62-40`| `-w` plus option value

|===

// | @rules_ocaml//cfg/executable/threads | True | `-thread`, `-no-thread`


**NOTE** These do not support `:enable`, `:disable` syntax.

**ATTRIBUTES** for rule **ocaml_binary**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_binary-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_binary-data"></a>+++data
|  Runtime dependencies: list of labels of data files needed by this executable at runtime. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_binary-cc_deps"></a>+++cc_deps
|  Dictionary specifying C/C++ library dependencies. Key: a target label; value: a linkmode string, which determines which file to link. Valid linkmodes: 'default', 'static', 'dynamic', 'shared' (synonym for 'dynamic'). For more information see [CC Dependencies: Linkmode](../ug/cc_deps.md#linkmode). | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_binary-cc_linkall"></a>+++cc_linkall
|  True: use `-whole-archive` (GCC toolchain) or `-force_load` (Clang toolchain). Deps in this attribute must also be listed in cc_deps. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_binary-cc_linkopts"></a>+++cc_linkopts
|  List of C/C++ link options. E.g. ["-lstd++"]. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_binary-data_prefix_map"></a>+++data_prefix_map
|  Map for replacing path prefixes of data files | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_binary-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_binary-epilogue"></a>+++epilogue
|  List of OCaml dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_binary-exe"></a>+++exe
|  By default, executable name is derived from 'name' attribute; use this to override. | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_binary-main"></a>+++main
|  Label of module containing entry point of executable. In the list of dependencies, this will be placed after 'prologue' deps and before 'epilogue' deps. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_binary-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_binary-prologue"></a>+++prologue
|  List of OCaml dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_binary-vm_runtime"></a>+++vm_runtime
|  @rules_ocaml//cfg/runtime:dynamic (default), @rules_ocaml//cfg/runtime:static, or a custom ocaml_vm_runtime target label | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//cfg/runtime:dynamic"

|===




== ocaml_exec_module

[.prototype]
pass:[
ocaml_exec_module(<a href="#ocaml_exec_module-name">name</a>, <a href="#ocaml_exec_module-deps">deps</a>, <a href="#ocaml_exec_module-data">data</a>, <a href="#ocaml_exec_module-cc_deps">cc_deps</a>, <a href="#ocaml_exec_module-cc_linkage">cc_linkage</a>, <a href="#ocaml_exec_module-deps_runtime">deps_runtime</a>, <a href="#ocaml_exec_module-env">env</a>, <a href="#ocaml_exec_module-module_name">module_name</a>,
                  <a href="#ocaml_exec_module-ns_resolver">ns_resolver</a>, <a href="#ocaml_exec_module-open">open</a>, <a href="#ocaml_exec_module-opts">opts</a>, <a href="#ocaml_exec_module-pack">pack</a>, <a href="#ocaml_exec_module-ppx">ppx</a>, <a href="#ocaml_exec_module-ppx_args">ppx_args</a>, <a href="#ocaml_exec_module-ppx_data">ppx_data</a>, <a href="#ocaml_exec_module-ppx_print">ppx_print</a>, <a href="#ocaml_exec_module-ppx_verbose">ppx_verbose</a>, <a href="#ocaml_exec_module-sig">sig</a>,
                  <a href="#ocaml_exec_module-struct">struct</a>)
]

See documentation for ocaml_module.

**ATTRIBUTES** for rule **ocaml_exec_module**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_exec_module-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_exec_module-deps"></a>+++deps
|  List of dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_exec_module-data"></a>+++data
|  Runtime data dependencies: list of labels of data files needed by this module at runtime. This is a standard Bazel attribute; see link:https://bazel.build/reference/be/common-definitions#typical-attributes[Typical attributes,window="_blank"]. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_exec_module-cc_deps"></a>+++cc_deps
|  Static (.a) or dynamic (.so, .dylib) libraries. Must by built or imported using Bazel's rules_cc ruleset (thus providing CcInfo output). | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_exec_module-cc_linkage"></a>+++cc_linkage
|  Dictionary specifying C/C++ library dependencies. Allows finer control over linking than the 'cc_deps' attribute. Key: a target label providing CcInfo; value: a linkmode string, which determines which file to link. Valid linkmodes: 'default', 'static', 'dynamic', 'shared' (synonym for 'dynamic'). For more information see link:../user-guide/dependencies-cc#_cc-linkmode[CC Dependencies: Linkmode]. | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_exec_module-deps_runtime"></a>+++deps_runtime
|  Runtime module dependencies, e.g. .cmxs plugins. Use the `data` attribute for runtime data dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_exec_module-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_exec_module-module_name"></a>+++module_name
|  Use this string as module name, instead of deriving it from sig or struct | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_exec_module-ns_resolver"></a>+++ns_resolver
|  NS resolver module for bottom-up namespacing. Modules may use this attribute to elect membership in a bottom-up namespace. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_exec_module-open"></a>+++open
|  List of OCaml dependencies to be passed with `-open`. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_exec_module-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_exec_module-pack"></a>+++pack
|  Experimental.  List of pack submodules. They will be compiled with -for-pack, and this module will be compile with -pack. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_exec_module-ppx"></a>+++ppx
|  Label of `ppx_executable` target to be used to transform source before compilation. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_exec_module-ppx_args"></a>+++ppx_args
|  Options to pass to PPX executable passed by the `ppx` attribute. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_exec_module-ppx_data"></a>+++ppx_data
|  PPX runtime data dependencies. List of labels of files needed by the PPX executable passed via the `ppx` attribute when it is executed to transform the source file. For example, a source file using link:https://github.com/janestreet/ppx_optcomp[ppx_optcomp] may import a file using extension `[%%import ]`; this file should be listed in this attribute. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_exec_module-ppx_print"></a>+++ppx_print
|  Format of output of PPX transform: binary (default) or text. Value must be one of `@rules_ocaml//ppx/print:binary!` or `@rules_ocaml//ppx/print:text!`. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//ppx/print"
| +++<a class="rule-attr" id="ocaml_exec_module-ppx_verbose"></a>+++ppx_verbose
|  - | +++Boolean+++
| optional
| False
| +++<a class="rule-attr" id="ocaml_exec_module-sig"></a>+++sig
|  Single label of a target producing `OcamlSignatureProvider` (i.e. rule `ocaml_signature`) OR a sig source file. Optional. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_exec_module-struct"></a>+++struct
|  A single module (struct) source file label. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| required
| 

|===




== ocaml_import

[.prototype]
pass:[
ocaml_import(<a href="#ocaml_import-name">name</a>, <a href="#ocaml_import-deps">deps</a>, <a href="#ocaml_import-srcs">srcs</a>, <a href="#ocaml_import-afiles">afiles</a>, <a href="#ocaml_import-all">all</a>, <a href="#ocaml_import-archive">archive</a>, <a href="#ocaml_import-astructs">astructs</a>, <a href="#ocaml_import-cc_deps">cc_deps</a>, <a href="#ocaml_import-cmtis">cmtis</a>, <a href="#ocaml_import-cmts">cmts</a>, <a href="#ocaml_import-cmxs">cmxs</a>, <a href="#ocaml_import-doc">doc</a>,
             <a href="#ocaml_import-jsoo_runtime">jsoo_runtime</a>, <a href="#ocaml_import-ocaml_version">ocaml_version</a>, <a href="#ocaml_import-ofiles">ofiles</a>, <a href="#ocaml_import-plugin">plugin</a>, <a href="#ocaml_import-ppx_codeps">ppx_codeps</a>, <a href="#ocaml_import-sigs">sigs</a>, <a href="#ocaml_import-version">version</a>, <a href="#ocaml_import-vmlibs">vmlibs</a>)
]

Imports pre-compiled OCaml files. [User Guide](../ug/ocaml_import.md).

**ATTRIBUTES** for rule **ocaml_import**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_import-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_import-deps"></a>+++deps
|  - | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-srcs"></a>+++srcs
|  - | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-afiles"></a>+++afiles
|  list of .a files that go with .cmxa files | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-all"></a>+++all
|  Glob all cm* files except for 'archive' or 'plugin' so theey can be added to action ldeps (rather than cmd line). I.e. the (transitive) deps of an archive, which must be accessible to the compiler (via search path, not command line), and so must be added to the action ldeps. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-archive"></a>+++archive
|  - | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_import-astructs"></a>+++astructs
|  - | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-cc_deps"></a>+++cc_deps
|  C archive files (.a) for integrating OCaml and C libs | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-cmtis"></a>+++cmtis
|  - | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-cmts"></a>+++cmts
|  - | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-cmxs"></a>+++cmxs
|  - | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_import-doc"></a>+++doc
|  - | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_import-jsoo_runtime"></a>+++jsoo_runtime
|  - | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_import-ocaml_version"></a>+++ocaml_version
|  - | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_import-ofiles"></a>+++ofiles
|  list of .o files that go with .cmx files | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-plugin"></a>+++plugin
|  - | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_import-ppx_codeps"></a>+++ppx_codeps
|  - | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-sigs"></a>+++sigs
|  - | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_import-version"></a>+++version
|  - | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_import-vmlibs"></a>+++vmlibs
|  Dynamically-loadable, for ocamlrun. Standard naming is 'dll<name>_stubs.so' or 'dll<name>.so'. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []

|===




== ocaml_library

[.prototype]
pass:[
ocaml_library(<a href="#ocaml_library-name">name</a>, <a href="#ocaml_library-archive_name">archive_name</a>, <a href="#ocaml_library-archived">archived</a>, <a href="#ocaml_library-cc_deps">cc_deps</a>, <a href="#ocaml_library-cc_linkage">cc_linkage</a>, <a href="#ocaml_library-env">env</a>, <a href="#ocaml_library-manifest">manifest</a>, <a href="#ocaml_library-ns_name">ns_name</a>, <a href="#ocaml_library-opts">opts</a>,
              <a href="#ocaml_library-shared">shared</a>, <a href="#ocaml_library-standalone">standalone</a>, <a href="#ocaml_library-vm_runtime">vm_runtime</a>)
]

Aggregates a collection of OCaml modules. [User Guide](../ug/ocaml_library.md). Provides: [OcamlLibraryMarker](providers_ocaml.md#ocamllibraryprovider).

An `ocaml_library` is a collection of modules packaged into an OBazl
target; it is not a single binary file. It is a OBazl convenience rule
that allows a target to depend on a collection of deps under a single
label, rather than having to list each individually.

Be careful not to confuse `ocaml_library` with `ocaml_archive`. The
latter generates OCaml binaries (`.cma`, `.cmxa`, '.a' archive files);
the former does not generate anything, it just passes on its
dependencies under a single label, packaged in a
[OcamlLibraryMarker](providers_ocaml.md#ocamllibraryprovider). For
more information see [Collections: Libraries, Archives and
Packages](../ug/collections.md).

**ATTRIBUTES** for rule **ocaml_library**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_library-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_library-archive_name"></a>+++archive_name
|  Name of generated archive file, without extension. If not provided, name will be derived from target 'name' attribute.  Ignored if archived == False. | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_library-archived"></a>+++archived
|  - | +++Boolean+++
| optional
| False
| +++<a class="rule-attr" id="ocaml_library-cc_deps"></a>+++cc_deps
|  Static (.a) or dynamic (.so, .dylib) libraries. Must deliver a CcInfo provider. Since ocaml rules may deliver CcInfo providers, we cannnot assume these deps are produced directly by rules_cc. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_library-cc_linkage"></a>+++cc_linkage
|  Dictionary specifying C/C++ library dependencies. Allows finer control over linking than the 'cc_deps' attribute. Key: a target label providing CcInfo; value: a linkmode string, which determines which file to link. Valid linkmodes: 'default', 'static', 'dynamic', 'shared' (synonym for 'dynamic'). For more information see link:../user-guide/dependencies-cc#_cc-linkmode[CC Dependencies: Linkmode]. | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_library-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_library-manifest"></a>+++manifest
|  List of component modules, for libraries and archives. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_library-ns_name"></a>+++ns_name
|  - | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_library-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_library-shared"></a>+++shared
|  True: build a shared lib (.cmxs) | +++Boolean+++
| optional
| False
| +++<a class="rule-attr" id="ocaml_library-standalone"></a>+++standalone
|  True: link total depgraph. False: link only direct deps. | +++Boolean+++
| optional
| False
| +++<a class="rule-attr" id="ocaml_library-vm_runtime"></a>+++vm_runtime
|  @rules_ocaml//cfg/runtime:dynamic (default), @rules_ocaml//cfg/runtime:static, or a custom ocaml_vm_runtime target label | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//cfg/runtime:dynamic"

|===




== ocaml_module

[.prototype]
pass:[
ocaml_module(<a href="#ocaml_module-name">name</a>, <a href="#ocaml_module-deps">deps</a>, <a href="#ocaml_module-data">data</a>, <a href="#ocaml_module-cc_deps">cc_deps</a>, <a href="#ocaml_module-cc_linkage">cc_linkage</a>, <a href="#ocaml_module-deps_runtime">deps_runtime</a>, <a href="#ocaml_module-env">env</a>, <a href="#ocaml_module-module_name">module_name</a>, <a href="#ocaml_module-ns_resolver">ns_resolver</a>,
             <a href="#ocaml_module-open">open</a>, <a href="#ocaml_module-opts">opts</a>, <a href="#ocaml_module-pack">pack</a>, <a href="#ocaml_module-ppx">ppx</a>, <a href="#ocaml_module-ppx_args">ppx_args</a>, <a href="#ocaml_module-ppx_data">ppx_data</a>, <a href="#ocaml_module-ppx_print">ppx_print</a>, <a href="#ocaml_module-ppx_verbose">ppx_verbose</a>, <a href="#ocaml_module-sig">sig</a>, <a href="#ocaml_module-struct">struct</a>)
]

Compiles an OCaml module. The **module name** is determined by rule,
based on the `struct`, `sig`, `name`, and `module` attributes:

* If the `sig` attribute is the label of an `ocaml_signature` target,
  then the module name is derived from the name of the compiled
  sigfile, since compiled interface files cannot be renamed. The
  structfile will be renamed if it does not match the sigfile name.

* If the `sig` attribute is a filename, then:

** if its principal name is equal to the principal name of the file
   named in the `struct` attribute, then the module name is derived
   from it.

** if the principal names of the sigfile and structfile do not match,
   then the module name is derived from from the `name` attribute.
   Both the sigfile and the structfile will be renamed accordingly.

** The `module` attribute may be used to force the module name. Both
   the sigfile and the structfile will be renamed accordingly.

* If the `sig` attribute is not specified (i.e. the structfile is
  "orphaned"), then the module name will be derived from the
  structfile name, unless the `module` attribute is specified, in
  which case it overrides.

**CONFIGURABLE DEFAULTS** for rule `ocaml_module`:

In addition to the <<Configurable defaults>> that apply to all
`ocaml_*` rules, the following apply to this rule:

**Options**

[.rule_attrs]
[cols="1,1,1"]
|===
| Label | Default | Comments

| @rules_ocaml//cfg/module:deps | `@rules_ocaml//cfg:null` | list of OCaml deps to add to all `ocaml_module` instances

| @rules_ocaml//cfg/module:cc_deps^1^ | `@rules_ocaml//cfg:null` | list of cc_deps to add to all `ocaml_module` instances

| @rules_ocaml//cfg/module:cc_linkstatic^1^ | `@rules_ocaml//cfg:null` | list of cc_deps to link statically (DEPRECATED)

| @rules_ocaml//cfg/module:warnings | `@1..3@5..28@30..39@43@46..47@49..57@61..62-40`| sets `-w` option for all `ocaml_module` instances

|===

^1^ See link:../user-guide/dependencies-cc[CC Dependencies] for more information on CC deps.

**Boolean Flags**

NOTE: These do not support `:enable`, `:disable` syntax.

[.rule_attrs]
[cols="1,1,1"]
|===
| Label | Default | `opts` attrib equivalent

| @rules_ocaml//cfg/module/linkall | False | `-linkall`, `-no-linkall`

| @rules_ocaml//cfg/module:verbose | False | `-verbose`, `-no-verbose`

|===

**ATTRIBUTES** for rule **ocaml_module**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_module-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_module-deps"></a>+++deps
|  List of dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_module-data"></a>+++data
|  Runtime data dependencies: list of labels of data files needed by this module at runtime. This is a standard Bazel attribute; see link:https://bazel.build/reference/be/common-definitions#typical-attributes[Typical attributes,window="_blank"]. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_module-cc_deps"></a>+++cc_deps
|  Static (.a) or dynamic (.so, .dylib) libraries. Must by built or imported using Bazel's rules_cc ruleset (thus providing CcInfo output). | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_module-cc_linkage"></a>+++cc_linkage
|  Dictionary specifying C/C++ library dependencies. Allows finer control over linking than the 'cc_deps' attribute. Key: a target label providing CcInfo; value: a linkmode string, which determines which file to link. Valid linkmodes: 'default', 'static', 'dynamic', 'shared' (synonym for 'dynamic'). For more information see link:../user-guide/dependencies-cc#_cc-linkmode[CC Dependencies: Linkmode]. | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_module-deps_runtime"></a>+++deps_runtime
|  Runtime module dependencies, e.g. .cmxs plugins. Use the `data` attribute for runtime data dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_module-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_module-module_name"></a>+++module_name
|  Use this string as module name, instead of deriving it from sig or struct | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_module-ns_resolver"></a>+++ns_resolver
|  NS resolver module for bottom-up namespacing. Modules may use this attribute to elect membership in a bottom-up namespace. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_module-open"></a>+++open
|  List of OCaml dependencies to be passed with `-open`. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_module-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_module-pack"></a>+++pack
|  Experimental.  List of pack submodules. They will be compiled with -for-pack, and this module will be compile with -pack. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_module-ppx"></a>+++ppx
|  Label of `ppx_executable` target to be used to transform source before compilation. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_module-ppx_args"></a>+++ppx_args
|  Options to pass to PPX executable passed by the `ppx` attribute. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_module-ppx_data"></a>+++ppx_data
|  PPX runtime data dependencies. List of labels of files needed by the PPX executable passed via the `ppx` attribute when it is executed to transform the source file. For example, a source file using link:https://github.com/janestreet/ppx_optcomp[ppx_optcomp] may import a file using extension `[%%import ]`; this file should be listed in this attribute. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_module-ppx_print"></a>+++ppx_print
|  Format of output of PPX transform: binary (default) or text. Value must be one of `@rules_ocaml//ppx/print:binary!` or `@rules_ocaml//ppx/print:text!`. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//ppx/print"
| +++<a class="rule-attr" id="ocaml_module-ppx_verbose"></a>+++ppx_verbose
|  - | +++Boolean+++
| optional
| False
| +++<a class="rule-attr" id="ocaml_module-sig"></a>+++sig
|  Single label of a target producing `OcamlSignatureProvider` (i.e. rule `ocaml_signature`) OR a sig source file. Optional. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_module-struct"></a>+++struct
|  A single module (struct) source file label. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| required
| 

|===




== ocaml_ns_archive

[.prototype]
pass:[
ocaml_ns_archive(<a href="#ocaml_ns_archive-name">name</a>, <a href="#ocaml_ns_archive-archive_name">archive_name</a>, <a href="#ocaml_ns_archive-cc_deps">cc_deps</a>, <a href="#ocaml_ns_archive-cc_linkage">cc_linkage</a>, <a href="#ocaml_ns_archive-env">env</a>, <a href="#ocaml_ns_archive-manifest">manifest</a>, <a href="#ocaml_ns_archive-ns_name">ns_name</a>, <a href="#ocaml_ns_archive-opts">opts</a>, <a href="#ocaml_ns_archive-shared">shared</a>)
]

Generate a 'namespace' module. [User Guide](../ug/ocaml_ns.md).  Provides: [OcamlNsMarker](providers_ocaml.md#ocamlnsmoduleprovider).

    Deprecated.  Use ocaml_ns_library with 'archived = True' instead.

**NOTE** 'name' must be a legal OCaml module name string.  Leading underscore is illegal.

See [Namespacing](../ug/namespacing.md) for more information on namespaces.

**ATTRIBUTES** for rule **ocaml_ns_archive**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_ns_archive-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_ns_archive-archive_name"></a>+++archive_name
|  Name of generated archive file, without extension. If not provided, name will be derived from target 'name' attribute.  Ignored if archived == False. | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_ns_archive-cc_deps"></a>+++cc_deps
|  Static (.a) or dynamic (.so, .dylib) libraries. Must by built or imported using Bazel's rules_cc ruleset (thus providing CcInfo output). | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_archive-cc_linkage"></a>+++cc_linkage
|  Dictionary specifying C/C++ library dependencies. Allows finer control over linking than the 'cc_deps' attribute. Key: a target label providing CcInfo; value: a linkmode string, which determines which file to link. Valid linkmodes: 'default', 'static', 'dynamic', 'shared' (synonym for 'dynamic'). For more information see link:../user-guide/dependencies-cc#_cc-linkmode[CC Dependencies: Linkmode]. | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_ns_archive-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_ns_archive-manifest"></a>+++manifest
|  List of namespaced submodules; will be renamed by prefixing the namespace, | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_archive-ns_name"></a>+++ns_name
|  Namespace name is derived from 'name' attribute by default; use this to override. | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_ns_archive-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_archive-shared"></a>+++shared
|  True: build a shared lib (.cmxs) | +++Boolean+++
| optional
| False

|===




== ocaml_ns_library

[.prototype]
pass:[
ocaml_ns_library(<a href="#ocaml_ns_library-name">name</a>, <a href="#ocaml_ns_library-archive_name">archive_name</a>, <a href="#ocaml_ns_library-archived">archived</a>, <a href="#ocaml_ns_library-cc_deps">cc_deps</a>, <a href="#ocaml_ns_library-cc_linkage">cc_linkage</a>, <a href="#ocaml_ns_library-env">env</a>, <a href="#ocaml_ns_library-manifest">manifest</a>, <a href="#ocaml_ns_library-ns_name">ns_name</a>, <a href="#ocaml_ns_library-opts">opts</a>,
                 <a href="#ocaml_ns_library-shared">shared</a>)
]

Generate a 'namespace' module. [User Guide](../ug/ocaml_ns.md).  Provides: [OcamlNsMarker](providers_ocaml.md#ocamlnsmoduleprovider).

**NOTE** 'name' must be a legal OCaml module name string.  Leading underscore is illegal.

See [Namespacing](../ug/namespacing.md) for more information on namespaces.

**ATTRIBUTES** for rule **ocaml_ns_library**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_ns_library-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_ns_library-archive_name"></a>+++archive_name
|  Name of generated archive file, without extension. If not provided, name will be derived from target 'name' attribute.  Ignored if archived == False. | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_ns_library-archived"></a>+++archived
|  - | +++Boolean+++
| optional
| False
| +++<a class="rule-attr" id="ocaml_ns_library-cc_deps"></a>+++cc_deps
|  Static (.a) or dynamic (.so, .dylib) libraries. Must by built or imported using Bazel's rules_cc ruleset (thus providing CcInfo output). | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_library-cc_linkage"></a>+++cc_linkage
|  Dictionary specifying C/C++ library dependencies. Allows finer control over linking than the 'cc_deps' attribute. Key: a target label providing CcInfo; value: a linkmode string, which determines which file to link. Valid linkmodes: 'default', 'static', 'dynamic', 'shared' (synonym for 'dynamic'). For more information see link:../user-guide/dependencies-cc#_cc-linkmode[CC Dependencies: Linkmode]. | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_ns_library-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_ns_library-manifest"></a>+++manifest
|  List of namespaced submodules; will be renamed by prefixing the namespace, | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_library-ns_name"></a>+++ns_name
|  Namespace name is derived from 'name' attribute by default; use this to override. | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_ns_library-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_library-shared"></a>+++shared
|  True: build a shared lib (.cmxs) | +++Boolean+++
| optional
| False

|===




== ocaml_ns_resolver

[.prototype]
pass:[
ocaml_ns_resolver(<a href="#ocaml_ns_resolver-name">name</a>, <a href="#ocaml_ns_resolver-deps">deps</a>, <a href="#ocaml_ns_resolver-data">data</a>, <a href="#ocaml_ns_resolver-cc_deps">cc_deps</a>, <a href="#ocaml_ns_resolver-cc_linkage">cc_linkage</a>, <a href="#ocaml_ns_resolver-deps_runtime">deps_runtime</a>, <a href="#ocaml_ns_resolver-embed">embed</a>, <a href="#ocaml_ns_resolver-env">env</a>, <a href="#ocaml_ns_resolver-include">include</a>,
                  <a href="#ocaml_ns_resolver-manifest">manifest</a>, <a href="#ocaml_ns_resolver-merge">merge</a>, <a href="#ocaml_ns_resolver-module_name">module_name</a>, <a href="#ocaml_ns_resolver-ns">ns</a>, <a href="#ocaml_ns_resolver-open">open</a>, <a href="#ocaml_ns_resolver-opts">opts</a>, <a href="#ocaml_ns_resolver-pack">pack</a>, <a href="#ocaml_ns_resolver-ppx">ppx</a>, <a href="#ocaml_ns_resolver-ppx_args">ppx_args</a>, <a href="#ocaml_ns_resolver-ppx_data">ppx_data</a>,
                  <a href="#ocaml_ns_resolver-ppx_print">ppx_print</a>, <a href="#ocaml_ns_resolver-ppx_verbose">ppx_verbose</a>, <a href="#ocaml_ns_resolver-sig">sig</a>, <a href="#ocaml_ns_resolver-struct">struct</a>)
]

OBSOLETE DOCSTRING!  under revision...

This rule initializes a 'namespace evaluation environment' consisting of a pseudo-namespace prefix string and optionally an ns resolver module.  A pseudo-namespace prefix string is a string that is used to form (by prefixation) a (presumably) globally unique name for a module. An ns resolver module is a module that contains nothing but alias equations mapping module names to pseudo-namespaced module names.

This rule is designed to work in conjujnction with rules
[ocaml_module](rules_ocaml.md#ocaml_module) and
[ocaml_ns_module](rules_ocaml.md#ocaml_ns_module). An `ocaml_module`
instance can use the prefix string of an `ppx_ns` to rename its
source file by using attribute `ns` to reference the label of an
`ppx_ns` target. Instances of `ocaml_ns_module` can list such
modules as `submodule` dependencies. They can also use an
`ppx_ns` prefix string to name themselves, by using their `ns`
attribute similarly. This allows ns modules to be (pseudo-)namespaced in the
same way submodules are namespaced.

The prefix string defaults to the (Bazel) package name string, with
each segment capitalized and the path separator ('/') replaced by the
`sep` string (default: `_`). If you pass a prefix string it must be a
legal OCaml module path; each segment will be capitalized and the segment
separator ('.') will be replaced by the `sep` string. The resulting
prefix may be used by `ocaml_module` rules (via the `ns` attribute) to
rename their source files, and, if `module = True`, by this rule to
generate alias equations.

For example, if package `//alpha/beta/gamma` contains`foo.ml`:

```
ns_resolver() => Alpha_Beta_Gamma__foo.ml
ns_resolver(sep="") => AlphaBetaGamma__foo.ml
ns_resolver(sep="__") => Alpha__Beta__Gamma__foo.ml
ns_resolver(prefix="foo.bar") => Foo_Bar__foo.ml (pkg path ignored)
ns_resolver(prefix="foo.bar", sep="") => FooBar__foo.ml
```

The optional ns resolver module will be named `<prefix>__00.ml`; since
`0` is not a legal initial character for an OCaml module name, this
ensures it will never clash with a user-defined module.

The ns resolver module will contain alias equations mapping module
names derived from the `srcs` list to pseudo-namespaced module names
(and thus indirectly filenames). For example, if `srcs` contains
`foo.ml`, and the prefix is `a.b`, then the resolver module will
contain `module Foo = A_b_foo`.

Submodule file names will be formed by prefixing the pseudo-ns prefix to the (original, un-namespaced) module name, separated by 'sep' (default: '__'). For example, if the prefix is 'Foo_bar' and the module is 'baz.ml', the submodule file name will be 'Foo_bar__baz.ml'.

The main namespace module will contain aliasing equations that map module names to these prefixed module names.

By default, the ns prefix string is formed from the package name, with '/' replaced by '_'. You can use the 'ns' attribute to change this:

ns(ns = "foobar", srcs = glob(["*.ml"]))

**ATTRIBUTES** for rule **ocaml_ns_resolver**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_ns_resolver-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_ns_resolver-deps"></a>+++deps
|  List of dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-data"></a>+++data
|  Runtime data dependencies: list of labels of data files needed by this module at runtime. This is a standard Bazel attribute; see link:https://bazel.build/reference/be/common-definitions#typical-attributes[Typical attributes,window="_blank"]. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-cc_deps"></a>+++cc_deps
|  Static (.a) or dynamic (.so, .dylib) libraries. Must by built or imported using Bazel's rules_cc ruleset (thus providing CcInfo output). | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-cc_linkage"></a>+++cc_linkage
|  Dictionary specifying C/C++ library dependencies. Allows finer control over linking than the 'cc_deps' attribute. Key: a target label providing CcInfo; value: a linkmode string, which determines which file to link. Valid linkmodes: 'default', 'static', 'dynamic', 'shared' (synonym for 'dynamic'). For more information see link:../user-guide/dependencies-cc#_cc-linkmode[CC Dependencies: Linkmode]. | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_ns_resolver-deps_runtime"></a>+++deps_runtime
|  Runtime module dependencies, e.g. .cmxs plugins. Use the `data` attribute for runtime data dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-embed"></a>+++embed
|  Exogenous namespaces (resolver modules). | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_ns_resolver-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_ns_resolver-include"></a>+++include
|  Exogenous (sub)modules, namespaced or non-namespaced.  Aliased names will not be prefixed with ns name of this ns_resolver.

Keys: labels of modules;
Values: alias name to be used in this resolver.

e.g. '//mwe/rgb:R': 'Red' will generate

module R = Red | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_ns_resolver-manifest"></a>+++manifest
|  List of strings from which submodule names are to be derived for aliasing. Bazel labels may be used; the submodule name will be derived from the target part. For example, '//a/b:c' normalizes to C. But they are just strings, and will not be checked against any files.

The normalized submodule names must match the names of the modules electing membership via the 'ns_resolver' attribute.

 Module source code generated by ocamllex and ocamlyacc can be accomodated by using the module name for the source file and generating a .ml source file of the same name, e.g. lexer.mll -> lexer.ml. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-merge"></a>+++merge
|  Includes all submodules of an exogenous namespace. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-module_name"></a>+++module_name
|  Use this string as module name, instead of deriving it from sig or struct | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_ns_resolver-ns"></a>+++ns
|  - | +++String+++
| required
| 
| +++<a class="rule-attr" id="ocaml_ns_resolver-open"></a>+++open
|  List of OCaml dependencies to be passed with `-open`. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-pack"></a>+++pack
|  Experimental.  List of pack submodules. They will be compiled with -for-pack, and this module will be compile with -pack. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-ppx"></a>+++ppx
|  Label of `ppx_executable` target to be used to transform source before compilation. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_ns_resolver-ppx_args"></a>+++ppx_args
|  Options to pass to PPX executable passed by the `ppx` attribute. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-ppx_data"></a>+++ppx_data
|  PPX runtime data dependencies. List of labels of files needed by the PPX executable passed via the `ppx` attribute when it is executed to transform the source file. For example, a source file using link:https://github.com/janestreet/ppx_optcomp[ppx_optcomp] may import a file using extension `[%%import ]`; this file should be listed in this attribute. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_ns_resolver-ppx_print"></a>+++ppx_print
|  Format of output of PPX transform: binary (default) or text. Value must be one of `@rules_ocaml//ppx/print:binary!` or `@rules_ocaml//ppx/print:text!`. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//ppx/print"
| +++<a class="rule-attr" id="ocaml_ns_resolver-ppx_verbose"></a>+++ppx_verbose
|  - | +++Boolean+++
| optional
| False
| +++<a class="rule-attr" id="ocaml_ns_resolver-sig"></a>+++sig
|  Single label of a target producing `OcamlSignatureProvider` (i.e. rule `ocaml_signature`) OR a sig source file. Optional. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_ns_resolver-struct"></a>+++struct
|  A single module (struct) source file label. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None

|===




== ocaml_signature

[.prototype]
pass:[
ocaml_signature(<a href="#ocaml_signature-name">name</a>, <a href="#ocaml_signature-deps">deps</a>, <a href="#ocaml_signature-src">src</a>, <a href="#ocaml_signature-data">data</a>, <a href="#ocaml_signature-env">env</a>, <a href="#ocaml_signature-module">module</a>, <a href="#ocaml_signature-ns_resolver">ns_resolver</a>, <a href="#ocaml_signature-open">open</a>, <a href="#ocaml_signature-opts">opts</a>, <a href="#ocaml_signature-pack">pack</a>, <a href="#ocaml_signature-ppx">ppx</a>, <a href="#ocaml_signature-ppx_args">ppx_args</a>,
                <a href="#ocaml_signature-ppx_data">ppx_data</a>, <a href="#ocaml_signature-ppx_print">ppx_print</a>, <a href="#ocaml_signature-ppx_verbose">ppx_verbose</a>, <a href="#ocaml_signature-xmo">xmo</a>)
]

Generates OCaml .cmi (inteface) file. [User Guide](../ug/ocaml_signature.md). Provides `OcamlSignatureProvider`.

**CONFIGURABLE DEFAULTS** for rule `ocaml_signature`

In addition to the <<Configurable defaults>> that
apply to all `ocaml_*` rules, the following apply to this rule. (Note
the difference between '/' and ':' in such labels):

[.rule_attrs]
[cols="1,1,1"]
|===
| Label | Default | `opts` attrib

| @rules_ocaml//cfg/signature/linkall | True | `-linkall`, `-no-linkall`

| @rules_ocaml//cfg/signature:warnings | `@1..3@5..28@30..39@43@46..47@49..57@61..62-40`| `-w` plus option value

|===

// | @rules_ocaml//cfg/signature/threads | False | true: `-I +threads`

**ATTRIBUTES** for rule **ocaml_signature**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_signature-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_signature-deps"></a>+++deps
|  List of OCaml dependencies. Use this for compiling a .mli source file with deps. See [Dependencies](#deps) for details. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_signature-src"></a>+++src
|  A single .mli source file label | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_signature-data"></a>+++data
|  - | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_signature-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_signature-module"></a>+++module
|  Set module (sig) name to this string | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_signature-ns_resolver"></a>+++ns_resolver
|  Bottom-up namespacing | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_signature-open"></a>+++open
|  List of OCaml dependencies to be passed with -open. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_signature-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_signature-pack"></a>+++pack
|  Experimental | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_signature-ppx"></a>+++ppx
|  Label of `ppx_executable` target to be used to transform source before compilation. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_signature-ppx_args"></a>+++ppx_args
|  Options to pass to PPX executable passed by the `ppx` attribute. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_signature-ppx_data"></a>+++ppx_data
|  PPX runtime data dependencies. List of labels of files needed by the PPX executable passed via the `ppx` attribute when it is executed to transform the source file. For example, a source file using link:https://github.com/janestreet/ppx_optcomp[ppx_optcomp] may import a file using extension `[%%import ]`; this file should be listed in this attribute. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_signature-ppx_print"></a>+++ppx_print
|  Format of output of PPX transform: binary (default) or text. Value must be one of `@rules_ocaml//ppx/print:binary!` or `@rules_ocaml//ppx/print:text!`. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//ppx/print"
| +++<a class="rule-attr" id="ocaml_signature-ppx_verbose"></a>+++ppx_verbose
|  - | +++Boolean+++
| optional
| False
| +++<a class="rule-attr" id="ocaml_signature-xmo"></a>+++xmo
|  Cross-module optimization. If false, compile with -opaque | +++Boolean+++
| optional
| True

|===




== ocaml_test

[.prototype]
pass:[
ocaml_test(<a href="#ocaml_test-name">name</a>, <a href="#ocaml_test-data">data</a>, <a href="#ocaml_test-cc_deps">cc_deps</a>, <a href="#ocaml_test-cc_libs">cc_libs</a>, <a href="#ocaml_test-cc_linkall">cc_linkall</a>, <a href="#ocaml_test-cc_linkopts">cc_linkopts</a>, <a href="#ocaml_test-data_prefix_map">data_prefix_map</a>, <a href="#ocaml_test-diff_cmd">diff_cmd</a>, <a href="#ocaml_test-env">env</a>,
           <a href="#ocaml_test-epilogue">epilogue</a>, <a href="#ocaml_test-exe">exe</a>, <a href="#ocaml_test-main">main</a>, <a href="#ocaml_test-opts">opts</a>, <a href="#ocaml_test-prologue">prologue</a>, <a href="#ocaml_test-vm_runtime">vm_runtime</a>)
]

OCaml test rule.

**CONFIGURABLE DEFAULTS** for rule `ocaml_test`

In addition to the [OCaml configurable defaults](#configdefs) that apply to all
`ocaml_*` rules, the following apply to this rule:

| Label | Default | `opts` attrib |
| ----- | ------- | ------- |
| @rules_ocaml//cfg/executable:linkall | True | `-linkall`, `-no-linkall`|
| @rules_ocaml//cfg/executable:threads | False | true: `-I +thread`|
| @rules_ocaml//cfg/executable:warnings | `@1..3@5..28@30..39@43@46..47@49..57@61..62-40`| `-w` plus option value |

**NOTE** These do not support `:enable`, `:disable` syntax.

 See [Configurable Defaults](../ug/configdefs_doc.md) for more information.

**ATTRIBUTES** for rule **ocaml_test**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_test-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_test-data"></a>+++data
|  Runtime dependencies: list of labels of data files needed by this executable at runtime. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_test-cc_deps"></a>+++cc_deps
|  Dictionary specifying C/C++ library dependencies. Key: a target label; value: a linkmode string, which determines which file to link. Valid linkmodes: 'default', 'static', 'dynamic', 'shared' (synonym for 'dynamic'). For more information see [CC Dependencies: Linkmode](../ug/cc_deps.md#linkmode). | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_test-cc_libs"></a>+++cc_libs
|  - | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_test-cc_linkall"></a>+++cc_linkall
|  True: use `-whole-archive` (GCC toolchain) or `-force_load` (Clang toolchain). Deps in this attribute must also be listed in cc_deps. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_test-cc_linkopts"></a>+++cc_linkopts
|  List of C/C++ link options. E.g. ["-lstd++"]. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_test-data_prefix_map"></a>+++data_prefix_map
|  Map for replacing path prefixes of data files | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_test-diff_cmd"></a>+++diff_cmd
|  - | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocaml_test-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ocaml_test-epilogue"></a>+++epilogue
|  List of OCaml dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_test-exe"></a>+++exe
|  By default, executable name is derived from 'name' attribute; use this to override. | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ocaml_test-main"></a>+++main
|  Label of module containing entry point of executable. In the list of dependencies, this will be placed after 'prologue' deps and before 'epilogue' deps. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_test-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_test-prologue"></a>+++prologue
|  List of OCaml dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ocaml_test-vm_runtime"></a>+++vm_runtime
|  @rules_ocaml//cfg/runtime:dynamic (default), @rules_ocaml//cfg/runtime:static, or a custom ocaml_vm_runtime target label | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//cfg/runtime:dynamic"

|===




== ocaml_vm_runtime

[.prototype]
pass:[
ocaml_vm_runtime(<a href="#ocaml_vm_runtime-name">name</a>, <a href="#ocaml_vm_runtime-deps">deps</a>)
]

User-defined runtime, using ocamlc -make-runtime

**ATTRIBUTES** for rule **ocaml_vm_runtime**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocaml_vm_runtime-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocaml_vm_runtime-deps"></a>+++deps
|  Libraries whose cc deps should be included in the runtime | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []

|===




== ocamllex

[.prototype]
pass:[
ocamllex(<a href="#ocamllex-name">name</a>, <a href="#ocamllex-src">src</a>, <a href="#ocamllex-out">out</a>, <a href="#ocamllex-opts">opts</a>)
]

Generates an OCaml source file from an ocamllex source file.

**ATTRIBUTES** for rule **ocamllex**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocamllex-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocamllex-src"></a>+++src
|  A single .mll source file label | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocamllex-out"></a>+++out
|  Output filename. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| required
| 
| +++<a class="rule-attr" id="ocamllex-opts"></a>+++opts
|  Options | +++List of strings+++
| optional
| []

|===




== ocamlyacc

[.prototype]
pass:[
ocamlyacc(<a href="#ocamlyacc-name">name</a>, <a href="#ocamlyacc-src">src</a>, <a href="#ocamlyacc-outs">outs</a>, <a href="#ocamlyacc-opts">opts</a>)
]

Generates OCaml source files from an ocamlyacc source file.

**ATTRIBUTES** for rule **ocamlyacc**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ocamlyacc-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ocamlyacc-src"></a>+++src
|  A single .mly ocamlyacc source file label | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ocamlyacc-outs"></a>+++outs
|  Output filenames. | +++List of labels+++
| required
| 
| +++<a class="rule-attr" id="ocamlyacc-opts"></a>+++opts
|  Options | +++List of strings+++
| optional
| []

|===




== ppx_executable

[.prototype]
pass:[
ppx_executable(<a href="#ppx_executable-name">name</a>, <a href="#ppx_executable-data">data</a>, <a href="#ppx_executable-bin">bin</a>, <a href="#ppx_executable-cc_deps">cc_deps</a>, <a href="#ppx_executable-cc_linkall">cc_linkall</a>, <a href="#ppx_executable-cc_linkopts">cc_linkopts</a>, <a href="#ppx_executable-data_prefix_map">data_prefix_map</a>, <a href="#ppx_executable-env">env</a>, <a href="#ppx_executable-epilogue">epilogue</a>,
               <a href="#ppx_executable-exe">exe</a>, <a href="#ppx_executable-main">main</a>, <a href="#ppx_executable-opts">opts</a>, <a href="#ppx_executable-ppx_codeps">ppx_codeps</a>, <a href="#ppx_executable-prologue">prologue</a>, <a href="#ppx_executable-vm_runtime">vm_runtime</a>)
]

Generates a PPX executable.  Provides: [PpxExecutableMarker](providers_ppx.md#ppxexecutableprovider).

**ATTRIBUTES** for rule **ppx_executable**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ppx_executable-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ppx_executable-data"></a>+++data
|  Runtime data dependencies. E.g. a file used by %%import from ppx_optcomp. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_executable-bin"></a>+++bin
|  Precompiled ppx executable | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ppx_executable-cc_deps"></a>+++cc_deps
|  C/C++ library dependencies | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ppx_executable-cc_linkall"></a>+++cc_linkall
|  True: use `-whole-archive` (GCC toolchain) or `-force_load` (Clang toolchain). Deps in this attribute must also be listed in cc_deps. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_executable-cc_linkopts"></a>+++cc_linkopts
|  List of C/C++ link options. E.g. `["-lstd++"]`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ppx_executable-data_prefix_map"></a>+++data_prefix_map
|  Map for replacing path prefixes of data files.  May be used to strip a path prefix (set value to empty string ""). | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ppx_executable-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ppx_executable-epilogue"></a>+++epilogue
|  List of OCaml dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_executable-exe"></a>+++exe
|  Name for output executable file.  Overrides 'name' attribute. | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ppx_executable-main"></a>+++main
|  A module to be listed after those in 'prologue' and before those in 'epilogue'. For more information see [Main Module](../ug/ppx.md#main_module). | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| required
| 
| +++<a class="rule-attr" id="ppx_executable-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ppx_executable-ppx_codeps"></a>+++ppx_codeps
|  List of non-opam adjunct dependencies (labels). | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_executable-prologue"></a>+++prologue
|  List of OCaml dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_executable-vm_runtime"></a>+++vm_runtime
|  @ocaml_rules//cfg/runtime:dynamic (default), @ocaml_rules//cfg/runtime:static, or a custom ocaml_vm_runtime target label | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//cfg/runtime:dynamic"

|===




== ppx_module

[.prototype]
pass:[
ppx_module(<a href="#ppx_module-name">name</a>, <a href="#ppx_module-deps">deps</a>, <a href="#ppx_module-data">data</a>, <a href="#ppx_module-cc_deps">cc_deps</a>, <a href="#ppx_module-cc_linkage">cc_linkage</a>, <a href="#ppx_module-deps_runtime">deps_runtime</a>, <a href="#ppx_module-env">env</a>, <a href="#ppx_module-module_name">module_name</a>, <a href="#ppx_module-ns_resolver">ns_resolver</a>, <a href="#ppx_module-open">open</a>,
           <a href="#ppx_module-opts">opts</a>, <a href="#ppx_module-pack">pack</a>, <a href="#ppx_module-ppx">ppx</a>, <a href="#ppx_module-ppx_args">ppx_args</a>, <a href="#ppx_module-ppx_codeps">ppx_codeps</a>, <a href="#ppx_module-ppx_compile_codeps">ppx_compile_codeps</a>, <a href="#ppx_module-ppx_data">ppx_data</a>, <a href="#ppx_module-ppx_link_codeps">ppx_link_codeps</a>,
           <a href="#ppx_module-ppx_print">ppx_print</a>, <a href="#ppx_module-ppx_verbose">ppx_verbose</a>, <a href="#ppx_module-sig">sig</a>, <a href="#ppx_module-struct">struct</a>)
]

Compiles a PPX module. Same as ocaml_module but with added ppx_codeps
attribute. A ppx_module may depend on a standard ocaml_module, but not
the other way around.

The **module name** is determined by rule,
based on the `struct`, `sig`, `name`, and `module` attributes:

* If the `sig` attribute is the label of an `ocaml_signature` target,
  then the module name is derived from the name of the compiled
  sigfile, since compiled interface files cannot be renamed. The
  structfile will be renamed if it does not match the sigfile name.

* If the `sig` attribute is a filename, then:

** if its principal name is equal to the principal name of the file
   named in the `struct` attribute, then the module name is derived
   from it.

** if the principal names of the sigfile and structfile do not match,
   then the module name is derived from from the `name` attribute.
   Both the sigfile and the structfile will be renamed accordingly.

** The `module` attribute may be used to force the module name. Both
   the sigfile and the structfile will be renamed accordingly.

* If the `sig` attribute is not specified (i.e. the structfile is
  "orphaned"), then the module name will be derived from the
  structfile name, unless the `module` attribute is specified, in
  which case it overrides.

**CONFIGURABLE DEFAULTS** for rule `ppx_module`:

In addition to the <<Configurable defaults>> that apply to all
`ocaml_*` rules, the following apply to this rule:

**Options**

[.rule_attrs]
[cols="1,1,1"]
|===
| Label | Default | Comments

| @rules_ocaml//cfg/module:deps | `@rules_ocaml//cfg:null` | list of OCaml deps to add to all `ocaml_module` instances

| @rules_ocaml//cfg/module:cc_deps^1^ | `@rules_ocaml//cfg:null` | list of cc_deps to add to all `ocaml_module` instances

| @rules_ocaml//cfg/module:cc_linkstatic^1^ | `@rules_ocaml//cfg:null` | list of cc_deps to link statically (DEPRECATED)

| @rules_ocaml//cfg/module:warnings | `@1..3@5..28@30..39@43@46..47@49..57@61..62-40`| sets `-w` option for all `ocaml_module` instances

|===

^1^ See link:../user-guide/dependencies-cc[CC Dependencies] for more information on CC deps.

**Boolean Flags**

NOTE: These do not support `:enable`, `:disable` syntax.

[.rule_attrs]
[cols="1,1,1"]
|===
| Label | Default | `opts` attrib equivalent

| @rules_ocaml//cfg/module/linkall | False | `-linkall`, `-no-linkall`

| @rules_ocaml//cfg/module:verbose | False | `-verbose`, `-no-verbose`

|===

**ATTRIBUTES** for rule **ppx_module**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ppx_module-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ppx_module-deps"></a>+++deps
|  List of dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-data"></a>+++data
|  Runtime data dependencies: list of labels of data files needed by this module at runtime. This is a standard Bazel attribute; see link:https://bazel.build/reference/be/common-definitions#typical-attributes[Typical attributes,window="_blank"]. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-cc_deps"></a>+++cc_deps
|  Static (.a) or dynamic (.so, .dylib) libraries. Must by built or imported using Bazel's rules_cc ruleset (thus providing CcInfo output). | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-cc_linkage"></a>+++cc_linkage
|  Dictionary specifying C/C++ library dependencies. Allows finer control over linking than the 'cc_deps' attribute. Key: a target label providing CcInfo; value: a linkmode string, which determines which file to link. Valid linkmodes: 'default', 'static', 'dynamic', 'shared' (synonym for 'dynamic'). For more information see link:../user-guide/dependencies-cc#_cc-linkmode[CC Dependencies: Linkmode]. | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: Label -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ppx_module-deps_runtime"></a>+++deps_runtime
|  Runtime module dependencies, e.g. .cmxs plugins. Use the `data` attribute for runtime data dependencies. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ppx_module-module_name"></a>+++module_name
|  Use this string as module name, instead of deriving it from sig or struct | +++String+++
| optional
| ""
| +++<a class="rule-attr" id="ppx_module-ns_resolver"></a>+++ns_resolver
|  NS resolver module for bottom-up namespacing. Modules may use this attribute to elect membership in a bottom-up namespace. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ppx_module-open"></a>+++open
|  List of OCaml dependencies to be passed with `-open`. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-pack"></a>+++pack
|  Experimental.  List of pack submodules. They will be compiled with -for-pack, and this module will be compile with -pack. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-ppx"></a>+++ppx
|  Label of `ppx_executable` target to be used to transform source before compilation. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ppx_module-ppx_args"></a>+++ppx_args
|  Options to pass to PPX executable passed by the `ppx` attribute. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-ppx_codeps"></a>+++ppx_codeps
|  List of non-opam adjunct dependencies (labels). | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-ppx_compile_codeps"></a>+++ppx_compile_codeps
|  List labels of compile-time dependencies. These are required to compile any file transformed by this ppx. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-ppx_data"></a>+++ppx_data
|  PPX runtime data dependencies. List of labels of files needed by the PPX executable passed via the `ppx` attribute when it is executed to transform the source file. For example, a source file using link:https://github.com/janestreet/ppx_optcomp[ppx_optcomp] may import a file using extension `[%%import ]`; this file should be listed in this attribute. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-ppx_link_codeps"></a>+++ppx_link_codeps
|  List labels of link-time dependencies. These are required to link any file transformed by this ppx. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_module-ppx_print"></a>+++ppx_print
|  Format of output of PPX transform: binary (default) or text. Value must be one of `@rules_ocaml//ppx/print:binary!` or `@rules_ocaml//ppx/print:text!`. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//ppx/print"
| +++<a class="rule-attr" id="ppx_module-ppx_verbose"></a>+++ppx_verbose
|  - | +++Boolean+++
| optional
| False
| +++<a class="rule-attr" id="ppx_module-sig"></a>+++sig
|  Single label of a target producing `OcamlSignatureProvider` (i.e. rule `ocaml_signature`) OR a sig source file. Optional. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ppx_module-struct"></a>+++struct
|  A single module (struct) source file label. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| required
| 

|===




== ppx_transform

[.prototype]
pass:[
ppx_transform(<a href="#ppx_transform-name">name</a>, <a href="#ppx_transform-src">src</a>, <a href="#ppx_transform-data">data</a>, <a href="#ppx_transform-args">args</a>, <a href="#ppx_transform-env">env</a>, <a href="#ppx_transform-opts">opts</a>, <a href="#ppx_transform-ppx">ppx</a>, <a href="#ppx_transform-print">print</a>)
]

Runs a ppx executable to transform a source file. Also propagates ppx_codeps from the provider of the ppx dependency.

**ATTRIBUTES** for rule **ppx_transform**:

[.rule_attrs]
[cols="1,1,1,1,1"]
|===
| Name  | Description | Type | Mandatory | Default

| +++<a class="rule-attr" id="ppx_transform-name"></a>+++name
|  A unique name for this target. | +++<a href="https://bazel.build/concepts/labels#target-names">Name</a>+++
| required
| 
| +++<a class="rule-attr" id="ppx_transform-src"></a>+++src
|  A single source file (struct or sig) label. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| required
| 
| +++<a class="rule-attr" id="ppx_transform-data"></a>+++data
|  Runtime data dependencies: list of labels of data files needed by ppx executable at runtime. | +++<a href="https://bazel.build/concepts/labels">List of labels</a>+++
| optional
| []
| +++<a class="rule-attr" id="ppx_transform-args"></a>+++args
|  List of args to pass to ppx executable at runtime. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ppx_transform-env"></a>+++env
|  Env variables | +++<a href="https://bazel.build/rules/lib/dict">Dictionary: String -> String</a>+++
| optional
| {}
| +++<a class="rule-attr" id="ppx_transform-opts"></a>+++opts
|  List of compile options; overrides configurable default options. Supports `+-no-+` prefix for each option; for example, `-no-linkall`. | +++List of strings+++
| optional
| []
| +++<a class="rule-attr" id="ppx_transform-ppx"></a>+++ppx
|  Label of `ppx_executable` target to be used to transform source before compilation. | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| None
| +++<a class="rule-attr" id="ppx_transform-print"></a>+++print
|  Format of output of PPX transform. Value must be one of `@rules_ocaml//ppx/print:binary`, `@rules_ocaml//ppx/print:text`.  See link:../ug/ppx.md#ppx_print[PPX Support] for more information | +++<a href="https://bazel.build/concepts/labels">Label</a>+++
| optional
| "@rules_ocaml//ppx/print"

|===



